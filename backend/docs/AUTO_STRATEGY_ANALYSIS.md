# Auto Strategy 機能分析レポート：課題と改善計画

## 概要

現在のオートストラテジー機能（`auto_strategy` モジュール）のコードベース分析により特定された、**未解決の課題**と**今後の改善計画**をまとめたドキュメントです。
完了済みの項目については [AUTO_STRATEGY_COMPLETED.md](./AUTO_STRATEGY_COMPLETED.md) を参照してください。

## 3. 設定と拡張性の課題 (Scalability & Configuration)

（課題 3.3 は解決済み：悲観的約定モデルと TPSL 拡張の実装により、バックテストの信頼性向上と戦略多様化を実現しました。）

## 4. データ分析・運用の課題

### 4.1 データベース分析の困難性 (Wait-for-Analysis Bottleneck)

**現状:**

- 戦略の構造データ（どの指標を使ったか、どのパラメータだったか）が `GeneratedStrategy` テーブルの `gene_data` カラム（JSON 型）にシリアライズされて格納されています。
- 「RSI を使用した戦略の平均勝率は？」といったメタ分析を行いたい場合、SQL レベルでの集計が困難で、アプリケーション側で全レコードをフェッチ・パースする必要があります。

**影響:**

- **科学的アプローチの阻害**: 数千、数万の仮想通貨戦略をバックテストした結果から「勝てるパターンの傾向」を導き出すためのデータマイニングが非常に非効率です。

## 推奨される改善アクション（優先度順）

### Phase 2: 機能拡張 (High Impact)

1. **エントリータイプの多様化検討**: 下位足シミュレーションの導入や、バー確定後の擬似指値ロジックなど、データ精度を担保できる範囲での指値・逆指値導入を検討する。

### Phase 3: データ基盤と分析 (Data & Analysis)

1. **戦略メタデータの正規化**: 分析用に、主要な戦略特性（使用指標、タイムフレーム、リスク許容度など）を別のカラムまたはテーブルに抽出して保存する仕組みを検討する。
2. **リスク指標の高度化**: 非正規分布に対応したリスク指標（Sortino Ratio, Omega Ratio, VaR, CVaR）の導入。
3. **パラメータ整合性チェックの強化**: `IndicatorManifest` にパラメータ間の依存関係ルール（`fast < slow` など）を定義し、生成・変異時に強制する。

### Phase 4: コード品質と保守性 (Maintenance)

1. **パラメータ範囲の局所化**: 指標ごとに異なるパラメータ範囲を設定できる仕組み（`IndicatorManifest` の拡張など）を検討する。
