# ã‚ªãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼å¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ é‹ç”¨ã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€ã‚ªãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼å¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ ã®æ–°æ©Ÿèƒ½ã®ä½¿ç”¨æ–¹æ³•ã€æœ€é©ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## ğŸš€ æ–°æ©Ÿèƒ½ä¸€è¦§

### 1. ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹å…±æœ‰ï¼ˆFitness Sharingï¼‰
- **ç›®çš„**: æˆ¦ç•¥ã®å¤šæ§˜æ€§å‘ä¸Š
- **åŠ¹æœ**: é¡ä¼¼æˆ¦ç•¥ã®è©•ä¾¡ã‚’ä¸‹ã’ã€å¤šæ§˜ãªæˆ¦ç•¥ã®å…±å­˜ã‚’ä¿ƒé€²

### 2. MLäºˆæ¸¬ç¢ºç‡æŒ‡æ¨™
- **æŒ‡æ¨™**: ML_UP_PROB, ML_DOWN_PROB, ML_RANGE_PROB
- **åŠ¹æœ**: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ä¾¡æ ¼äºˆæ¸¬ã‚’æˆ¦ç•¥ç”Ÿæˆã«æ´»ç”¨

### 3. ã‚·ãƒ§ãƒ¼ãƒˆãƒã‚¤ã‚¢ã‚¹çªç„¶å¤‰ç•°
- **ç›®çš„**: ã‚·ãƒ§ãƒ¼ãƒˆæˆ¦ç•¥ã®ç”Ÿæˆå¼·åŒ–
- **åŠ¹æœ**: ãƒ­ãƒ³ã‚°ãƒ»ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ©ãƒ³ã‚¹ã®æ”¹å–„

### 4. é«˜åº¦ãªç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°
- **æ©Ÿèƒ½**: ãƒ•ã‚¡ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã€å»ºç‰æ®‹é«˜ã‚’æ´»ç”¨ã—ãŸç‰¹å¾´é‡
- **åŠ¹æœ**: å¸‚å ´ã®æ­ªã¿ã‚„åã‚Šã‚’æ¤œå‡º

## âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šæŒ‡é‡

### GAè¨­å®šï¼ˆGAConfigï¼‰

#### åŸºæœ¬è¨­å®š
```python
config = GAConfig()
config.population_size = 50      # å€‹ä½“æ•°ï¼ˆæ¨å¥¨: 30-100ï¼‰
config.generations = 30          # ä¸–ä»£æ•°ï¼ˆæ¨å¥¨: 20-50ï¼‰
config.crossover_rate = 0.7      # äº¤å‰ç‡ï¼ˆæ¨å¥¨: 0.6-0.8ï¼‰
config.mutation_rate = 0.1       # çªç„¶å¤‰ç•°ç‡ï¼ˆæ¨å¥¨: 0.05-0.15ï¼‰
```

#### ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹å…±æœ‰è¨­å®š
```python
config.enable_fitness_sharing = True    # ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹å…±æœ‰ã‚’æœ‰åŠ¹åŒ–
config.sharing_radius = 0.1             # å…±æœ‰åŠå¾„ï¼ˆæ¨å¥¨: 0.05-0.2ï¼‰
config.sharing_alpha = 1.0              # å…±æœ‰é–¢æ•°ã®å½¢çŠ¶ï¼ˆæ¨å¥¨: 0.5-2.0ï¼‰
```

#### ã‚·ãƒ§ãƒ¼ãƒˆãƒã‚¤ã‚¢ã‚¹è¨­å®š
```python
config.enable_short_bias_mutation = True  # ã‚·ãƒ§ãƒ¼ãƒˆãƒã‚¤ã‚¢ã‚¹ã‚’æœ‰åŠ¹åŒ–
config.short_bias_rate = 0.3              # ãƒã‚¤ã‚¢ã‚¹é©ç”¨ç‡ï¼ˆæ¨å¥¨: 0.2-0.5ï¼‰
```

#### ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹é‡ã¿è¨­å®š
```python
config.fitness_weights = {
    "total_return": 0.25,      # ç·ãƒªã‚¿ãƒ¼ãƒ³
    "sharpe_ratio": 0.35,      # ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª
    "max_drawdown": 0.2,       # æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³
    "win_rate": 0.1,           # å‹ç‡
    "balance_score": 0.1       # ãƒ­ãƒ³ã‚°ãƒ»ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ©ãƒ³ã‚¹
}
```

### æ¨å¥¨è¨­å®šãƒ‘ã‚¿ãƒ¼ãƒ³

#### 1. ãƒãƒ©ãƒ³ã‚¹é‡è¦–è¨­å®š
```python
config.enable_fitness_sharing = True
config.sharing_radius = 0.15
config.enable_short_bias_mutation = True
config.short_bias_rate = 0.4
config.fitness_weights["balance_score"] = 0.15
```

#### 2. é«˜æ€§èƒ½é‡è¦–è¨­å®š
```python
config.enable_fitness_sharing = True
config.sharing_radius = 0.1
config.enable_short_bias_mutation = False
config.fitness_weights["total_return"] = 0.4
config.fitness_weights["sharpe_ratio"] = 0.4
```

#### 3. å¤šæ§˜æ€§é‡è¦–è¨­å®š
```python
config.enable_fitness_sharing = True
config.sharing_radius = 0.2
config.sharing_alpha = 1.5
config.enable_short_bias_mutation = True
config.short_bias_rate = 0.3
```

## ğŸ”§ é‹ç”¨æ‰‹é †

### 1. ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•å‰ã®ç¢ºèª

#### å¿…è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç¢ºèª
```bash
cd backend
python run_library_tests.py
```

#### MLæŒ‡æ¨™ã®å‹•ä½œç¢ºèª
```bash
python run_ml_indicator_tests.py
```

### 2. åŸºæœ¬çš„ãªé‹ç”¨ãƒ•ãƒ­ãƒ¼

#### Step 1: ãƒ‡ãƒ¼ã‚¿æº–å‚™
- OHLCVä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿
- ãƒ•ã‚¡ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- å»ºç‰æ®‹é«˜ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

#### Step 2: GAè¨­å®š
```python
from app.core.services.auto_strategy.models.ga_config import GAConfig

config = GAConfig()
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š...
```

#### Step 3: æˆ¦ç•¥ç”Ÿæˆå®Ÿè¡Œ
```python
from app.core.services.auto_strategy.auto_strategy_service import AutoStrategyService

service = AutoStrategyService()
result = service.generate_strategies(config, market_data)
```

#### Step 4: çµæœè©•ä¾¡
- ç”Ÿæˆã•ã‚ŒãŸæˆ¦ç•¥ã®å¤šæ§˜æ€§ç¢ºèª
- ãƒ­ãƒ³ã‚°ãƒ»ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ©ãƒ³ã‚¹ç¢ºèª
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ç¢ºèª

### 3. MLæ©Ÿèƒ½ã®æ´»ç”¨

#### MLãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’
```python
from app.core.services.ml import MLSignalGenerator

generator = MLSignalGenerator()
result = generator.train_model(training_data)
```

#### å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿
```python
generator.load_model("path/to/model.pkl")
```

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**: `MemoryError` ãŒç™ºç”Ÿ
**åŸå› **: å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿å‡¦ç†
**è§£æ±ºæ–¹æ³•**:
- ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’åˆ¶é™ï¼ˆæœ€æ–°50,000è¡Œãªã©ï¼‰
- ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’å°ã•ãã™ã‚‹
- ä¸è¦ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢

```python
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
feature_service.clear_cache()

# ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºåˆ¶é™
data = data.tail(10000)
```

#### 2. MLæŒ‡æ¨™è¨ˆç®—ã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**: MLæŒ‡æ¨™ãŒè¨ˆç®—ã•ã‚Œãªã„
**åŸå› **: ãƒ¢ãƒ‡ãƒ«æœªå­¦ç¿’ã€ãƒ‡ãƒ¼ã‚¿ä¸è¶³
**è§£æ±ºæ–¹æ³•**:
- ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’çŠ¶æ…‹ç¢ºèª
- ååˆ†ãªãƒ‡ãƒ¼ã‚¿é‡ã®ç¢ºä¿

```python
# ãƒ¢ãƒ‡ãƒ«çŠ¶æ…‹ç¢ºèª
status = ml_service.get_model_status()
print(status)

# æœ€å°ãƒ‡ãƒ¼ã‚¿é‡ç¢ºèªï¼ˆ100è¡Œä»¥ä¸Šæ¨å¥¨ï¼‰
if len(data) < 100:
    print("ãƒ‡ãƒ¼ã‚¿é‡ãŒä¸è¶³ã—ã¦ã„ã¾ã™")
```

#### 3. ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹å…±æœ‰ãŒåŠ¹ã‹ãªã„
**ç—‡çŠ¶**: æˆ¦ç•¥ã®å¤šæ§˜æ€§ãŒå‘ä¸Šã—ãªã„
**åŸå› **: å…±æœ‰åŠå¾„ã®è¨­å®šä¸é©åˆ‡
**è§£æ±ºæ–¹æ³•**:
- å…±æœ‰åŠå¾„ã‚’èª¿æ•´ï¼ˆ0.05-0.2ï¼‰
- å€‹ä½“æ•°ã‚’å¢—åŠ 

```python
config.sharing_radius = 0.15  # èª¿æ•´
config.population_size = 100  # å¢—åŠ 
```

#### 4. ã‚·ãƒ§ãƒ¼ãƒˆæˆ¦ç•¥ãŒç”Ÿæˆã•ã‚Œãªã„
**ç—‡çŠ¶**: ãƒ­ãƒ³ã‚°æˆ¦ç•¥ã°ã‹ã‚Šç”Ÿæˆã•ã‚Œã‚‹
**åŸå› **: ã‚·ãƒ§ãƒ¼ãƒˆãƒã‚¤ã‚¢ã‚¹è¨­å®šä¸é©åˆ‡
**è§£æ±ºæ–¹æ³•**:
- ã‚·ãƒ§ãƒ¼ãƒˆãƒã‚¤ã‚¢ã‚¹ç‡ã‚’ä¸Šã’ã‚‹
- ã‚·ãƒ§ãƒ¼ãƒˆç‰¹åŒ–æŒ‡æ¨™ã‚’è¿½åŠ 

```python
config.short_bias_rate = 0.5  # å¢—åŠ 
config.allowed_indicators.extend(['ML_DOWN_PROB'])
```

### ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª

#### ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è¨­å®š
```python
import logging
logging.basicConfig(level=logging.INFO)
```

#### ä¸»è¦ãªãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- `âœ… æ­£å¸¸å‡¦ç†`: æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- `âš ï¸ è­¦å‘Š`: æ³¨æ„ãŒå¿…è¦ãªçŠ¶æ³
- `âŒ ã‚¨ãƒ©ãƒ¼`: å‡¦ç†å¤±æ•—

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨
```python
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥æƒ…å ±ç¢ºèª
cache_info = feature_service.get_cache_info()
print(cache_info)
```

#### 2. ãƒ‡ãƒ¼ã‚¿å‹æœ€é©åŒ–
- è‡ªå‹•çš„ã«float64â†’float32ã«å¤‰æ›
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç´„50%å‰Šæ¸›

#### 3. ä¸¦åˆ—å‡¦ç†è¨­å®š
```python
config.parallel_processes = 4  # CPUã‚³ã‚¢æ•°ã«å¿œã˜ã¦èª¿æ•´
```

## ğŸ“Š ç›£è¦–ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### å®šæœŸçš„ãªç¢ºèªé …ç›®

#### 1. ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚º
- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°

#### 2. æˆ¦ç•¥å“è³ª
- å¤šæ§˜æ€§æŒ‡æ¨™
- ãƒãƒ©ãƒ³ã‚¹ã‚¹ã‚³ã‚¢
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

#### 3. MLãƒ¢ãƒ‡ãƒ«
- äºˆæ¸¬ç²¾åº¦
- ç‰¹å¾´é‡é‡è¦åº¦
- ãƒ¢ãƒ‡ãƒ«æ›´æ–°é »åº¦

### ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ‰‹é †

#### é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
2. ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†
3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèª

#### æœˆæ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
1. MLãƒ¢ãƒ‡ãƒ«å†å­¦ç¿’
2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
3. ã‚·ã‚¹ãƒ†ãƒ æ›´æ–°

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### æŠ€è¡“ã‚µãƒãƒ¼ãƒˆ
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æä¾›
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©³ç´°

### æ”¹å–„è¦æœ›
- æ–°æ©Ÿèƒ½ã®ææ¡ˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„
- UI/UXæ”¹å–„

---

ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’å‚è€ƒã«ã€ã‚ªãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼å¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’åŠ¹æœçš„ã«é‹ç”¨ã—ã¦ãã ã•ã„ã€‚
