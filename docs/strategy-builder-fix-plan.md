# ストラテジービルダー機能修正計画

## 📋 修正概要

設計ドキュメントとの差分を解消し、完全な実装を達成するための修正計画です。

## 🔍 発見された問題

### 1. テクニカル指標数の不足
- **現状**: 47種類実装済み
- **目標**: 58種類（+11個追加が必要）
- **優先度**: 高

### 2. APIエンドポイントの不足
- **現状**: 7個実装済み
- **目標**: 8個（previewエンドポイント追加が必要）
- **優先度**: 中

### 3. バックテストエンドポイント拡張の確認
- **現状**: USER_CUSTOM戦略タイプ対応済み（要確認）
- **目標**: 完全な統合確認
- **優先度**: 低

## 🎯 修正タスク

### Phase 1: テクニカル指標の追加（TDD）

#### Task 1.1: 不足指標の特定と実装計画
- [ ] 設計ドキュメントから不足指標リストを作成
- [ ] カテゴリ別実装優先度を決定
- [ ] 各指標のテストケース設計

#### Task 1.2: Volume系指標の実装（3個）
- [ ] OBV (On-Balance Volume)
- [ ] AD (Accumulation/Distribution)
- [ ] ADOSC (Chaikin A/D Oscillator)

#### Task 1.3: Price Transform系指標の実装（12個）
- [ ] AVGPRICE, MEDPRICE, TYPPRICE, WCLPRICE
- [ ] HT_DCPERIOD, HT_DCPHASE, HT_PHASOR, HT_SINE, HT_TRENDMODE
- [ ] FAMA, SAREXT, SAR

#### Task 1.4: Momentum系指標の追加（2個）
- [ ] 不足している2個の特定と実装

#### Task 1.5: Volatility系指標の追加（3個）
- [ ] 不足している3個の特定と実装

### Phase 2: APIエンドポイントの追加（TDD）

#### Task 2.1: Preview エンドポイントの実装
- [ ] テストケース作成
- [ ] エンドポイント実装
- [ ] フロントエンド統合

### Phase 3: 統合テストと検証

#### Task 3.1: バックテスト統合の確認
- [ ] USER_CUSTOM戦略タイプの完全テスト
- [ ] エンドツーエンドテスト

#### Task 3.2: 最終検証
- [ ] 全58指標の動作確認
- [ ] 全8エンドポイントの動作確認
- [ ] パフォーマンステスト

## 🧪 TDD実装手順

### 1. Red Phase（テスト失敗）
各タスクで最初にテストを作成し、失敗することを確認

### 2. Green Phase（最小実装）
テストが通る最小限の実装を行う

### 3. Refactor Phase（リファクタリング）
コードの品質を向上させる

## 📊 進捗管理

### 完了基準
- [ ] 58種類のテクニカル指標が利用可能
- [ ] 8個のAPIエンドポイントが正常動作
- [ ] 全テストケースが成功
- [ ] 設計ドキュメントとの完全一致

### 品質基準
- [ ] コードカバレッジ90%以上
- [ ] APIレスポンス時間500ms以下
- [ ] エラーハンドリング100%実装
- [ ] ドキュメント更新完了

## 🚀 実装開始

次のステップ：Task 1.1から開始し、TDDサイクルで実装を進める。
